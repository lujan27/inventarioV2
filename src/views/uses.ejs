<%- include('includes/sidebar.ejs') %>
<%- include('includes/header.ejs') %>


<body>
    <section class="home-section">
        <%- include('includes/nav.ejs') %>
    <div class="container mt-2">
        <%- include('includes/alerts.ejs') %>

            <div class="row pt-4 mt-4">
                <div class="col-md-8 mx-auto pb-4 mb-4">

                <a href="#" onclick="window.history.back()" class="btn btn-outline-dark btn-sm mb-4">
                    <i class='bx bx-arrow-back pr-1'></i>Regresar
                </a>

                    <div class="card">
                        <div class="card-header text-center">
                            REGISTRAR USO DE MATERIAL
                        </div>
                        <div class="card-body">
                            <form action="/uses/<%=uso._id%>?_method=PUT" method="POST">
                                 
                                <div class="form-group">
                                    <label>Rancho: </label>
                                    <input type="text" class="form-control" name="ranch_owner" value="<%=uso.ranch_owner%>" readonly>
                                </div>

                                <div class="form-group">
                                    <label>Materia prima: </label>
                                    <input type="text" class="form-control" name="name" value="<%=uso.name%>" readonly>
                                </div>
                                <div class="form-group">
                                    <label>Descripci√≥n: </label>
                                    <input type="text" class="form-control" name="description" value="<%=uso.description%>" readonly>
                                </div>
                                <div class="form-group">
                                    <label>Unidad de medida: </label>
                                    <input type="text" class="form-control" name="unit" value="<%=uso.unit%>" readonly>
                                </div>
                                <div class="form-group">
                                    <label>Cantidad gastada: </label>
                                    <input id="cantidad" type="number" class="form-control" name="quantity" value="1" max="<%=uso.quantity%>" min="1" onchange="validarDatos();">
                                </div>                                
                                                                                                                            
                                
                                <div class="form-group">
                                    <button class="btn btn-outline-primary btn-block" id="Gdisabled">Guardar</button>
                                </div>
                                
                            </form>
                        </div>
                    </div>


                </div>
            </div>


    </div>
    <br>
<%- include('includes/foot.ejs') %>
</section>
 


<%- include('includes/scripts') %>

<script>

    function validarDatos(){

        var quantity = Number(document.getElementById('cantidad').value);
        var quantity_max = Number(document.getElementById('cantidad').max);

        var btnValidar = document.getElementById('Gdisabled');


        // console.log(quantity);
        // console.log(quantity_max);

        if(quantity > quantity_max){
            alert('No puede superar la cantidad que existe en el inventario');            
                document.getElementById('cantidad').value = quantity_max;
        } else {
            document.getElementById('cantidad').value = quantity;
        }
    }
    
</script>

<%- include('includes/footer.ejs') %>